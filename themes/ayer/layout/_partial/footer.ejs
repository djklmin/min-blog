<footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        <% if (theme.since && !isNaN(theme.since) && theme.since < date(new Date(), 'YYYY')) { %><%- theme.since%>-<% } %><%= date(new Date(), 'YYYY') %>
        <i class="ri-heart-fill heart_icon"></i> <%= config.author || config.title %>
      </li>
    </ul>
    <ul>
      <li>
        <% if (theme.pageFooter){ %>
        <% var hexoLink = '<a href="https://hexo.io" target="_blank">Hexo</a>'; %>
        <% var themeLink = '<a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>'; %>
        <%- __('powered_by', hexoLink) %>
        <span class="division">|</span>
        <%- __('theme', themeLink) %>
        <% } %>
      </li>
    </ul>
    <ul>
      <li>
        <% if (theme.busuanzi && theme.busuanzi.enable){ %>
        <%# "ä¸è’œå­ç»Ÿè®¡" %>
        <%- partial('post/busuanzi') %>
        <% } %>
      </li>
    </ul>
    <ul>
      <% if (theme.icp&&theme.icp.enable){ %>
        <li>
          <a href="<%= theme.icp.url %>" target="_black" rel="nofollow"><%= theme.icp.text %></a>
        </li>
        <% } %>
    </ul>
    <ul>
      <% if (theme.gongan&&theme.gongan.enable){ %>
      <li>
          <img src="<%= theme.gongan.img %>"></img>
          <a href="<%= theme.gongan.url %>" target="_black" rel="nofollow"><%= theme.gongan.text %></a>
      </li>
        <% } %>
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        <% if (theme.cnzz&&theme.cnzz.enable){ %>
        <script type="text/javascript" src='<%= theme.cnzz.url%>'></script>
        <% } %>
      </li>
    </ul>
  </div>
</footer>

<!-- Live2D çœ‹æ¿å¨˜æœ¬åœ°åŠ è½½ -->
<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/live2d-widget@latest/dist/waifu.css">
<script src="https://fastly.jsdelivr.net/npm/live2d-widget@latest/dist/waifu-tips.js"></script>

<script>
// ç­‰å¾…èµ„æºåŠ è½½å®Œæˆ
function initLive2DWidget() {
    if (typeof initWidget === 'undefined') {
        console.log('â³ ç­‰å¾…çœ‹æ¿å¨˜èµ„æºåŠ è½½...');
        setTimeout(initLive2DWidget, 100);
        return;
    }
    
    console.log('ğŸ¯ å¼€å§‹åˆå§‹åŒ–æœ¬åœ°æ¨¡å‹çœ‹æ¿å¨˜');
    
    // ä½¿ç”¨æœ¬åœ°LSSæ¨¡å‹çš„é…ç½®
    initWidget({
        // æ¨¡å‹é…ç½®
        model: {
            jsonPath: '/live2d_models/lss/LSS.model3.json',
            scale: 1,
            homeUrl: '/'
        },
        // æ˜¾ç¤ºè®¾ç½®
        display: {
            position: 'right',
            width: 220,
            height: 400,
            hOffset: 0,
            vOffset: -20,
            superSample: 2
        },
        // ç§»åŠ¨ç«¯è®¾ç½®
        mobile: {
            show: true,
            scale: 0.6,
            motion: true
        },
        // äº¤äº’è®¾ç½®
        react: {
            opacity: 0.9,
            opacityDefault: 0.7,
            opacityOnHover: 0.9
        },
        // å¯¹è¯è®¾ç½®
        dialog: {
            enable: true,
            script: {
                click: [
                    "å˜¿ï¼æ¬¢è¿æ¥åˆ°æˆ‘çš„å°çªï¼âœ§(â‰– â—¡ â‰–âœ¿)",
                    "è¿™æ˜¯ä¸€ä¸ªç”¨ Hexo + Ayer ä¸»é¢˜æ­å»ºçš„åšå®¢~",
                    "æ¬¢è¿æ¥åˆ°è¿™ä¸ªåšå®¢ï¼Œè¯·å¤šæŒ‡æ•™ï¼",
                    "å¸Œæœ›ä½ èƒ½åœ¨è¿™é‡Œæ‰¾åˆ°æœ‰è¶£çš„å†…å®¹ï¼",
                    "æœ‰ä»€ä¹ˆæƒ³è¯´çš„å¯ä»¥ç»™æˆ‘ç•™è¨€å“¦ï¼"
                ],
                idle: [
                    "ä»Šå¤©å¤©æ°”çœŸä¸é”™å‘¢...",
                    "å¥½æ— èŠå•Šï¼Œé™ªæˆ‘ç©ä¼šå„¿å˜›~",
                    "ä½ è¯´ï¼Œæˆ‘ä¸ºä»€ä¹ˆä¼šåœ¨è¿™é‡Œå‘¢ï¼Ÿ",
                    "å·å·å‘Šè¯‰ä½ ï¼Œåšä¸»æœ€è¿‘åˆåœ¨æŠ˜è…¾æ–°ä¸œè¥¿äº†",
                    "å—¯...æˆ‘åœ¨æƒ³ä»Šæ™šåƒä»€ä¹ˆå¥½å‘¢ï¼Ÿ"
                ]
            }
        },
        // å·¥å…·æ è®¾ç½®
        tools: {
            enable: true,
            items: ["switch-model", "switch-texture", "photo", "info", "quit"]
        },
        // å…¶ä»–è®¾ç½®
        drag: true,
        logLevel: 'error',
        waifuPath: 'https://fastly.jsdelivr.net/npm/live2d-widget@latest/dist/waifu-tips.json'
    });
    
    console.log('âœ… çœ‹æ¿å¨˜é…ç½®å®Œæˆ');
}

// é¡µé¢åŠ è½½å¤„ç†
function setupLive2D() {
    // ç§»åŠ¨è®¾å¤‡æ£€æµ‹
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth <= 768;
    
    if (isMobile) {
        console.log('ğŸ“± ç§»åŠ¨è®¾å¤‡æ£€æµ‹');
        // ç§»åŠ¨ç«¯å»¶è¿ŸåŠ è½½
        setTimeout(initLive2DWidget, 2000);
    } else {
        // PCç«¯ç«‹å³åŠ è½½
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(initLive2DWidget, 1000);
            });
        } else {
            setTimeout(initLive2DWidget, 1500);
        }
    }
}

// å¯åŠ¨çœ‹æ¿å¨˜åŠ è½½
setupLive2D();

// å¤‡ç”¨åŠ è½½æœºåˆ¶
setTimeout(function() {
    if (typeof initWidget === 'undefined') {
        console.log('ğŸ”„ å¤‡ç”¨åŠ è½½æœºåˆ¶å¯åŠ¨');
        // é‡æ–°å°è¯•åŠ è½½èµ„æº
        const script = document.createElement('script');
        script.src = 'https://fastly.jsdelivr.net/npm/live2d-widget@latest/dist/waifu-tips.js';
        script.onload = initLive2DWidget;
        document.head.appendChild(script);
    }
}, 5000);

// é”™è¯¯å¤„ç†
window.addEventListener('error', function(e) {
    if (e.filename && e.filename.includes('live2d')) {
        console.warn('Live2Dç›¸å…³é”™è¯¯:', e.message);
    }
});
</script>

<% if (theme.busuanzi && theme.busuanzi.enable){ %>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<% } %>


